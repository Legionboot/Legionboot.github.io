# MonoFlow Messenger (концепт)

Монохромная Single Page Application, имитирующая многопанельный мессенджер с плавающими окнами, мультитач-жестами и локальным хранением данных.

## Запуск
1. Склонируйте репозиторий или сохраните файлы локально.
2. Откройте `index.html` в современном браузере (Chrome, Edge, Safari, Firefox). Интернет требуется только для CDN AnimeJS.
3. При необходимости запустите любой статический сервер (`python -m http.server`) и откройте `http://localhost:8000`.

## Структура проекта
```
├── index.html              # Стартовая страница SPA
├── css/
│   ├── styles.css          # Базовая тема, типографика, layout (mobile-first)
│   └── windows.css         # Стили плавающих окон и состояний
├── js/
│   ├── app.js              # Точка входа, связывание модулей
│   ├── animations.js       # Обёртки над AnimeJS для анимаций
│   ├── db.js               # Локальная БД (localStorage) с seed-данными
│   ├── gestures.js         # Мультитач-жесты и распознавание Pointer Events
│   ├── ui.js               # Рендер списков, сообщений, файлов
│   └── windows.js          # Менеджер плавающих окон (drag/resize/snap)
├── assets/                 # Папка для иконок и изображений (пример: app-icon.svg)
└── README.md
```

## Тема интерфейса
* По умолчанию используется стиль `iOS`. Переключить между `iOS` и `Material` можно кнопкой в шапке.
* Для кастомизации обновите CSS-переменные в `styles.css` (`data-theme-style="ios" | "material"`).

## Локальная база данных
* Данные хранятся в `localStorage` под ключом `local_messenger_db_v1`.
* Поддерживаются операции:
  * `init(seed=false)` — инициализация/seed данных.
  * `getConversations()` — список бесед.
  * `getConversation(id)` — метаданные беседы.
  * `getMessages(convId, opts)` — сообщения с пагинацией.
  * `saveMessage(convId, message)` — сохранение сообщения.
  * `createConversation(meta)` — создание беседы.
  * `markRead(convId)` — сброс счётчика непрочитанных.
  * `resetDb()` — сброс в исходное состояние.
  * `exportJson()` — экспорт JSON для копирования/резерва.
  * `importJson(json)` — импорт JSON из textarea.

### Импорт/экспорт
1. Нажмите «Экспорт JSON», скопируйте содержимое textarea.
2. Для импорта вставьте JSON в textarea и нажмите «Импорт JSON».
3. «Сброс БД» откатывает seed-данные.

## Управление и жесты
* Drag окна — за заголовок (Pointer Events + `setPointerCapture`).
* Pinch (2 пальца) — масштаб окна.
* Rotate (2 пальца) — временный поворот окна.
* Трёхпальцевый свайп вниз — сворачивание.
* Долгий тап — включает/отключает модальный стиль окна.
* Поддержка мыши: drag, resize, zoom колесом (как pinch).
* Клавиатура: `Ctrl/Cmd + K` — окно поиска; `Esc` — закрыть последнее активное окно.

## Расширение
* Подключить настоящую сетевую БД можно, заменив реализацию в `db.js`.
* Для real-time синхронизации/видео-связи добавьте WebRTC/WebSocket клиенты в `app.js`.
* Жесты можно дополнить в `gestures.js`, например, четырёхпальцевым свайпом для режима презентации.

## Анимации
* Используется CDN AnimeJS (`https://cdn.jsdelivr.net/npm/animejs@3.2.1`).
* Основные обёртки — `animateWindowIntro`, `animateWindowClose`, `pulseAvatar`, `badgeFlash`, `toast` (расширяйте при необходимости).

Приятного прототипирования!
