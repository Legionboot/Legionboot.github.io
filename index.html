<!DOCTYPE html>
<html lang="ru" data-theme="ios">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Legion Messenger — монохромный SPA-мессенджер</title>
    <link rel="stylesheet" href="css/styles.css" />
    <link rel="stylesheet" href="css/windows.css" />
    <link rel="icon" href="assets/app-icon.svg" />
    <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" defer></script>
    <script type="module" src="js/app.js" defer></script>
  </head>
  <body>
    <div id="app" class="app-shell" aria-live="polite">
      <header class="app-header" role="banner">
        <button class="profile-btn" id="profileButton" aria-label="Профиль" tabindex="0">
          <svg viewBox="0 0 64 64" role="img" aria-hidden="true">
            <circle cx="32" cy="20" r="14" class="avatar-head"></circle>
            <path d="M12 54c4-10 12-16 20-16s16 6 20 16" class="avatar-body"></path>
          </svg>
        </button>
        <div class="brand">
          <h1>Legion Messenger</h1>
          <p class="brand-subtitle">Монохромный опыт будущего</p>
        </div>
        <div class="header-actions">
          <button id="themeToggle" class="ghost-button" aria-label="Переключить стиль">iOS ⇆ Material</button>
          <button id="openSearch" class="ghost-button" aria-label="Открыть поиск (Ctrl/Cmd+K)">
            Поиск
          </button>
        </div>
      </header>

      <main class="workspace" role="main">
        <section class="column conversations" aria-label="Список бесед">
          <div class="column-header">
            <h2>Диалоги</h2>
            <button id="newConversation" class="ghost-button">Новая беседа</button>
          </div>
          <nav id="conversationList" role="list" class="conversation-list" aria-live="polite"></nav>
        </section>

        <section class="column messages" aria-label="Сообщения">
          <header class="column-header">
            <h2 id="conversationTitle">Выберите беседу</h2>
            <div class="column-sub">
              <span id="conversationStatus">—</span>
            </div>
          </header>
          <div id="messageView" class="message-view" role="log" aria-live="polite"></div>
          <form id="messageForm" class="message-form" autocomplete="off">
            <label for="messageInput" class="sr-only">Введите сообщение</label>
            <textarea
              id="messageInput"
              class="message-input"
              rows="1"
              placeholder="Введите сообщение… (Shift+Enter — новая строка)"
              aria-label="Поле ввода сообщения"
            ></textarea>
            <button type="submit" class="primary-button" aria-label="Отправить сообщение">Отправить</button>
          </form>
        </section>

        <aside class="column repo" aria-label="Репозиторий файлов">
          <header class="column-header">
            <h2>Репозиторий</h2>
            <button id="openRepoWindow" class="ghost-button">Открыть окно</button>
          </header>
          <div id="repoList" class="repo-list" role="list"></div>
          <div class="db-tools">
            <h3>Импорт / Экспорт</h3>
            <textarea id="dbJson" rows="4" placeholder="JSON базы данных"></textarea>
            <div class="db-buttons">
              <button id="exportDb" class="ghost-button">Экспортировать</button>
              <button id="importDb" class="ghost-button">Импортировать</button>
              <button id="resetDb" class="ghost-button">Сбросить</button>
            </div>
          </div>
        </aside>
      </main>

      <section id="windowsLayer" class="windows-layer" aria-label="Плавающие окна"></section>
    </div>

    <template id="conversationItemTemplate">
      <button class="conversation-item" role="listitem">
        <span class="conversation-name"></span>
        <span class="conversation-meta">
          <span class="conversation-time"></span>
          <span class="conversation-unread" aria-hidden="true"></span>
        </span>
      </button>
    </template>

    <template id="messageBubbleTemplate">
      <article class="message-bubble" role="article">
        <header class="message-meta">
          <span class="message-author"></span>
          <time class="message-time"></time>
        </header>
        <p class="message-text"></p>
      </article>
    </template>

    <template id="repoItemTemplate">
      <div class="repo-item" role="listitem">
        <svg viewBox="0 0 32 32" aria-hidden="true">
          <rect x="6" y="4" width="20" height="24" rx="4" ry="4"></rect>
          <line x1="10" y1="12" x2="22" y2="12"></line>
          <line x1="10" y1="18" x2="22" y2="18"></line>
          <line x1="10" y1="24" x2="22" y2="24"></line>
        </svg>
        <div>
          <p class="repo-name"></p>
          <p class="repo-sub"></p>
        </div>
      </div>
    </template>
  </body>
</html>
